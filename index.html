<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C4D Botanical Particles</title>
    <meta
      name="description"
      content="Cinema 4D-style particle system with morphing, texture colors, and audio synchronization"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ============================================================
           RESET & BASE
           ============================================================ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        overflow: hidden;
        background: #030306;
        color: #e0e0e0;
      }

      #canvas-container {
        width: 100vw;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
      }

      /* ============================================================
           CONTROL PANEL â€” Glassmorphism
           ============================================================ */
      #controls {
        position: fixed;
        top: 16px;
        left: 16px;
        width: 320px;
        max-height: calc(100vh - 32px);
        overflow-y: auto;
        background: rgba(8, 8, 18, 0.75);
        backdrop-filter: blur(24px) saturate(1.4);
        -webkit-backdrop-filter: blur(24px) saturate(1.4);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 16px;
        padding: 20px 18px;
        z-index: 100;
        scrollbar-width: thin;
        scrollbar-color: rgba(255, 255, 255, 0.08) transparent;
      }
      #controls::-webkit-scrollbar {
        width: 4px;
      }
      #controls::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
      }

      /* ---- Title ---- */
      .panel-title {
        font-size: 16px;
        font-weight: 700;
        letter-spacing: -0.3px;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .panel-title .accent {
        background: linear-gradient(135deg, #ff4da6, #7c3aed, #00d4ff);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      /* ---- Section headers ---- */
      .section-header {
        font-size: 10px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1.2px;
        color: rgba(255, 255, 255, 0.35);
        margin: 16px 0 10px;
      }

      /* ---- Divider ---- */
      .divider {
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(124, 58, 237, 0.3),
          rgba(0, 212, 255, 0.15),
          transparent
        );
        margin: 14px 0;
      }

      /* ---- Control groups ---- */
      .control-group {
        margin-bottom: 12px;
      }
      .control-group label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 12px;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 6px;
      }

      /* ---- Value display (right side of label) ---- */
      .val {
        font-variant-numeric: tabular-nums;
        color: #a78bfa;
        font-weight: 600;
        font-size: 11px;
      }

      /* ---- File inputs ---- */
      input[type="file"] {
        width: 100%;
        padding: 8px 10px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        color: #ccc;
        font-size: 11px;
        cursor: pointer;
        transition: border-color 0.2s;
      }
      input[type="file"]:hover {
        border-color: rgba(124, 58, 237, 0.4);
      }
      input[type="file"]::file-selector-button {
        background: linear-gradient(135deg, #7c3aed, #a855f7);
        border: none;
        padding: 5px 12px;
        border-radius: 5px;
        cursor: pointer;
        color: #fff;
        font-weight: 600;
        font-size: 11px;
        margin-right: 8px;
        transition: opacity 0.2s;
      }
      input[type="file"]::file-selector-button:hover {
        opacity: 0.85;
      }

      /* ---- Range sliders ---- */
      input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 2px;
        background: rgba(255, 255, 255, 0.06);
        border-radius: 1px;
        outline: none;
        cursor: pointer;
      }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 12px;
        height: 12px;
        background: #a78bfa;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 0 6px rgba(167, 139, 250, 0.4);
        transition: box-shadow 0.2s;
      }
      input[type="range"]::-webkit-slider-thumb:hover {
        box-shadow: 0 0 10px rgba(167, 139, 250, 0.6);
      }

      /* ---- Color pickers ---- */
      input[type="color"] {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 32px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        cursor: pointer;
        background: transparent;
        padding: 2px;
      }
      input[type="color"]::-webkit-color-swatch-wrapper {
        padding: 2px;
      }
      input[type="color"]::-webkit-color-swatch {
        border-radius: 6px;
        border: none;
      }

      /* ---- Select dropdowns ---- */
      select {
        width: 100%;
        padding: 8px 10px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        color: #ccc;
        font-size: 12px;
        font-family: inherit;
        cursor: pointer;
        transition: border-color 0.2s;
      }
      select:hover {
        border-color: rgba(124, 58, 237, 0.4);
      }
      select option {
        background: #111;
        color: #ddd;
      }

      /* ---- Buttons ---- */
      .btn {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 8px;
        font-family: inherit;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.25s;
        margin-top: 6px;
      }
      .btn-primary {
        background: linear-gradient(135deg, #7c3aed, #a855f7);
        color: #fff;
      }
      .btn-primary:hover {
        opacity: 0.9;
        transform: translateY(-1px);
      }
      .btn-primary:disabled {
        background: rgba(255, 255, 255, 0.06);
        color: rgba(255, 255, 255, 0.25);
        cursor: not-allowed;
        transform: none;
      }
      .btn-outline {
        background: transparent;
        border: 1px solid rgba(167, 139, 250, 0.35);
        color: #a78bfa;
      }
      .btn-outline:hover {
        background: rgba(167, 139, 250, 0.08);
        border-color: rgba(167, 139, 250, 0.6);
      }
      .btn-outline:disabled {
        border-color: rgba(255, 255, 255, 0.06);
        color: rgba(255, 255, 255, 0.2);
        cursor: not-allowed;
      }

      /* ---- Checkbox ---- */
      .checkbox-row {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.6);
        margin-top: 8px;
      }
      .checkbox-row input[type="checkbox"] {
        accent-color: #7c3aed;
        width: 14px;
        height: 14px;
      }

      /* ============================================================
           STATS PANEL
           ============================================================ */
      #stats {
        position: fixed;
        bottom: 16px;
        left: 16px;
        background: rgba(8, 8, 18, 0.7);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 14px 16px;
        font-size: 11px;
        z-index: 100;
        min-width: 200px;
      }
      .stat-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2px 0;
      }
      .stat-label {
        color: rgba(255, 255, 255, 0.4);
        font-weight: 500;
      }
      .stat-value {
        font-weight: 600;
        font-variant-numeric: tabular-nums;
        color: #a78bfa;
      }

      /* ---- Beat indicator ---- */
      #beat-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        background: #f472b6;
        border-radius: 50%;
        box-shadow: 0 0 10px #f472b6;
        opacity: 0.15;
        transition: opacity 0.08s;
        margin-left: 4px;
        vertical-align: middle;
      }

      /* ---- Frequency bars (tiny inline) ---- */
      .freq-bars {
        display: flex;
        gap: 6px;
        margin-top: 6px;
      }
      .freq-bar-group {
        flex: 1;
        text-align: center;
      }
      .freq-bar-group .freq-label {
        font-size: 9px;
        color: rgba(255, 255, 255, 0.3);
        text-transform: uppercase;
        margin-bottom: 2px;
      }
      .freq-bar-group .freq-value {
        font-size: 10px;
        font-weight: 600;
        color: #a78bfa;
      }
    </style>
  </head>
  <body>
    <div id="canvas-container"></div>

    <!-- ============================================================
         CONTROL PANEL
         ============================================================ -->
    <div id="controls">
      <div class="panel-title">
        ðŸŒ¸ <span class="accent">C4D Botanical Particles</span>
      </div>

      <!-- ---- Import ---- -->
      <div class="section-header">Import</div>

      <div class="control-group">
        <label>GLB / GLTF Model</label>
        <input type="file" id="model-upload" accept=".glb,.gltf" />
      </div>

      <div class="control-group">
        <label>Audio File</label>
        <input type="file" id="audio-upload" accept="audio/*" />
      </div>

      <button id="play-pause" class="btn btn-primary" disabled>
        â–¶ Play Audio
      </button>

      <div class="divider"></div>

      <!-- ---- Color ---- -->
      <div class="section-header">Color</div>

      <div class="control-group">
        <label>Color Mode</label>
        <select id="color-mode">
          <option value="gradient">Custom Gradient</option>
          <option value="model">Model / Texture Color</option>
        </select>
      </div>

      <div class="control-group" id="gradient-colors">
        <label>Gradient Start</label>
        <input type="color" id="color-start" value="#ff0080" />
        <label style="margin-top: 8px">Gradient End</label>
        <input type="color" id="color-end" value="#00d4ff" />
      </div>

      <div class="control-group">
        <label>Blend Mode</label>
        <select id="blend-mode">
          <option value="additive">Additive (Glow)</option>
          <option value="normal">Normal (Solid)</option>
        </select>
      </div>

      <div class="divider"></div>

      <!-- ---- Particles ---- -->
      <div class="section-header">Particles</div>

      <div class="control-group">
        <label
          >Count <span class="val" id="particle-count-val">100000</span></label
        >
        <input
          type="range"
          id="particle-count"
          min="5000"
          max="200000"
          step="5000"
          value="100000"
        />
      </div>

      <div class="control-group">
        <label>Size <span class="val" id="particle-size-val">0.05</span></label>
        <input
          type="range"
          id="particle-size"
          min="0.005"
          max="0.20"
          step="0.005"
          value="0.05"
        />
      </div>

      <div class="control-group">
        <label
          >Turbulence <span class="val" id="turbulence-val">0.10</span></label
        >
        <input
          type="range"
          id="turbulence"
          min="0"
          max="2"
          step="0.05"
          value="0.10"
        />
      </div>

      <div class="divider"></div>

      <!-- ---- Morphing ---- -->
      <div class="section-header">Morphing</div>

      <div class="control-group">
        <label
          >Morph Speed
          <span class="val" id="morph-speed-val">0.020</span></label
        >
        <input
          type="range"
          id="morph-speed"
          min="0.005"
          max="0.10"
          step="0.005"
          value="0.02"
        />
      </div>

      <button id="morph-toggle" class="btn btn-outline" disabled>
        ðŸŒ¸ Morph to Model
      </button>

      <div class="checkbox-row">
        <input type="checkbox" id="auto-morph" checked />
        <span>Auto-morph on beat</span>
      </div>

      <div class="divider"></div>

      <!-- ---- Audio ---- -->
      <div class="section-header">Audio Reactivity</div>

      <div class="control-group">
        <label
          >Reactivity <span class="val" id="reactivity-val">1.0</span></label
        >
        <input
          type="range"
          id="reactivity"
          min="0"
          max="3"
          step="0.1"
          value="1.0"
        />
      </div>

      <div class="control-group">
        <label
          >Attenuation <span class="val" id="attenuation-val">0.95</span></label
        >
        <input
          type="range"
          id="attenuation"
          min="0.80"
          max="0.99"
          step="0.01"
          value="0.95"
        />
      </div>

      <div class="divider"></div>

      <!-- ---- Visual FX ---- -->
      <div class="section-header">Visual Effects</div>

      <div class="control-group">
        <label
          >Bloom Intensity
          <span class="val" id="bloom-intensity-val">1.2</span></label
        >
        <input
          type="range"
          id="bloom-intensity"
          min="0"
          max="3"
          step="0.05"
          value="1.2"
        />
      </div>
    </div>

    <!-- ============================================================
         STATS PANEL
         ============================================================ -->
    <div id="stats">
      <div class="stat-row">
        <span class="stat-label">FPS</span>
        <span class="stat-value" id="fps">0</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Particles</span>
        <span class="stat-value" id="particle-total">0</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Audio Level</span>
        <span class="stat-value" id="audio-level">0</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Model</span>
        <span class="stat-value" id="model-name">None</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Morph</span>
        <span class="stat-value" id="morph-state">Scattered</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Beat</span>
        <span class="stat-value"><span id="beat-indicator"></span></span>
      </div>

      <!-- Frequency bars -->
      <div class="freq-bars">
        <div class="freq-bar-group">
          <div class="freq-label">Bass</div>
          <div class="freq-value" id="bass-level">0%</div>
        </div>
        <div class="freq-bar-group">
          <div class="freq-label">Mid</div>
          <div class="freq-value" id="mid-level">0%</div>
        </div>
        <div class="freq-bar-group">
          <div class="freq-label">Treble</div>
          <div class="freq-value" id="treble-level">0%</div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
